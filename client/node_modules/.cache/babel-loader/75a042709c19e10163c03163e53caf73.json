{"ast":null,"code":"import _toConsumableArray from\"/Users/ruchikaashokbharati/Documents/SocialMediaProject-main/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/ruchikaashokbharati/Documents/SocialMediaProject-main/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useRef,useEffect}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{GLOBALTYPES}from\"../redux/actions/globalTypes\";import{createPost,updatePost}from\"../redux/actions/postAction\";import Icons from\"./Icons\";import{imageShow,videoShow}from\"../utils/mediaShow\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var StatusModal=function StatusModal(){var _useSelector=useSelector(function(state){return state;}),auth=_useSelector.auth,theme=_useSelector.theme,status=_useSelector.status,socket=_useSelector.socket;var dispatch=useDispatch();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),content=_useState2[0],setContent=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),images=_useState4[0],setImages=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),stream=_useState6[0],setStream=_useState6[1];var videoRef=useRef();var refCanvas=useRef();var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),tracks=_useState8[0],setTracks=_useState8[1];var handleChangeImages=function handleChangeImages(e){var files=_toConsumableArray(e.target.files);var err=\"\";var newImages=[];files.forEach(function(file){if(!file){return err=\"File does not exist.\";}if(file.size>1024*1024*5){return err=\"Image size must be less than 5 mb.\";}return newImages.push(file);});if(err){dispatch({type:GLOBALTYPES.ALERT,payload:{error:err}});}setImages([].concat(_toConsumableArray(images),newImages));};var deleteImages=function deleteImages(index){var newArr=_toConsumableArray(images);newArr.splice(index,1);setImages(newArr);};var handleStream=function handleStream(){setStream(true);if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){navigator.mediaDevices.getUserMedia({video:true}).then(function(mediaStream){videoRef.current.srcObject=mediaStream;videoRef.current.play();var track=mediaStream.getTracks();setTracks(track[0]);}).catch(function(err){return console.log(err);});}};var handleCapture=function handleCapture(){var width=videoRef.current.clientWidth;var height=videoRef.current.clientHeight;refCanvas.current.setAttribute(\"width\",width);refCanvas.current.setAttribute(\"height\",height);var ctx=refCanvas.current.getContext(\"2d\");ctx.drawImage(videoRef.current,0,0,width,height);var URL=refCanvas.current.toDataURL();setImages([].concat(_toConsumableArray(images),[{camera:URL}]));};var handleStopStream=function handleStopStream(){tracks.stop();setStream(false);};var handleSubmit=function handleSubmit(e){e.preventDefault();if(images.length===0){return dispatch({type:GLOBALTYPES.ALERT,payload:{error:\"Add image(s).\"}});}if(status.onEdit){dispatch(updatePost({content:content,images:images,auth:auth,status:status}));}else{dispatch(createPost({content:content,images:images,auth:auth,socket:socket}));}setContent(\"\");setImages([]);if(tracks){tracks.stop();}dispatch({type:GLOBALTYPES.STATUS,payload:false});};useEffect(function(){if(status.onEdit){setContent(status.content);setImages(status.images);}},[status]);return/*#__PURE__*/_jsx(\"div\",{className:\"status_modal\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"status_header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"m-0\",children:\"Create Post\"}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return dispatch({type:GLOBALTYPES.STATUS,payload:false});},children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"status_body\",children:[/*#__PURE__*/_jsx(\"textarea\",{onChange:function onChange(e){return setContent(e.target.value);},value:content,name:\"content\",placeholder:\"\".concat(auth.user.username,\", What's on your mind?\"),style:{filter:theme?\"invert(1)\":\"invert(0)\",color:theme?\"white\":\"#111\",background:theme?\"rgb(0,0,0,0.3)\":\"\"}}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-fill\"}),/*#__PURE__*/_jsx(Icons,{setContent:setContent,content:content,theme:theme})]}),/*#__PURE__*/_jsx(\"div\",{className:\"show_images\",children:images.map(function(img,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"file_img\",children:[img.camera?imageShow(img.camera,theme):img.url?/*#__PURE__*/_jsx(_Fragment,{children:img.url.match(/video/i)?videoShow(img.url):imageShow(img.url)}):/*#__PURE__*/_jsx(_Fragment,{children:img.type.match(/video/i)?videoShow(URL.createObjectURL(img,theme)):imageShow(URL.createObjectURL(img,theme))}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return deleteImages(index);},children:\"\\xD7\"})]},index);})}),stream&&/*#__PURE__*/_jsxs(\"div\",{className:\"stream position-relative\",children:[/*#__PURE__*/_jsx(\"video\",{width:\"100%\",height:\"100%\",ref:videoRef,style:{filter:theme?\"invert(1)\":\"invert(0)\"},autoPlay:true,muted:true}),/*#__PURE__*/_jsx(\"span\",{onClick:handleStopStream,children:\"\\xD7\"}),/*#__PURE__*/_jsx(\"canvas\",{style:{display:\"none\"},ref:refCanvas})]}),/*#__PURE__*/_jsx(\"div\",{className:\"input_images\",children:stream?/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-camera\",onClick:handleCapture}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-camera\",onClick:handleStream}),/*#__PURE__*/_jsxs(\"div\",{className:\"file_upload\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-image\"}),/*#__PURE__*/_jsx(\"input\",{onChange:handleChangeImages,type:\"file\",name:\"file\",id:\"file\",multiple:true,accept:\"image/*,video/*\"})]})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"status_footer\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary w-100\",children:\"Post\"})})]})});};export default StatusModal;","map":{"version":3,"sources":["/Users/ruchikaashokbharati/Documents/SocialMediaProject-main/client/src/components/StatusModal.js"],"names":["React","useState","useRef","useEffect","useDispatch","useSelector","GLOBALTYPES","createPost","updatePost","Icons","imageShow","videoShow","StatusModal","state","auth","theme","status","socket","dispatch","content","setContent","images","setImages","stream","setStream","videoRef","refCanvas","tracks","setTracks","handleChangeImages","e","files","target","err","newImages","forEach","file","size","push","type","ALERT","payload","error","deleteImages","index","newArr","splice","handleStream","navigator","mediaDevices","getUserMedia","video","then","mediaStream","current","srcObject","play","track","getTracks","catch","console","log","handleCapture","width","clientWidth","height","clientHeight","setAttribute","ctx","getContext","drawImage","URL","toDataURL","camera","handleStopStream","stop","handleSubmit","preventDefault","length","onEdit","STATUS","value","user","username","filter","color","background","map","img","url","match","createObjectURL","display"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { GLOBALTYPES } from \"../redux/actions/globalTypes\";\nimport { createPost, updatePost } from \"../redux/actions/postAction\";\nimport Icons from \"./Icons\";\nimport { imageShow, videoShow } from \"../utils/mediaShow\";\n\nconst StatusModal = () => {\n  const { auth, theme, status, socket } = useSelector((state) => state);\n  const dispatch = useDispatch();\n  const [content, setContent] = useState(\"\");\n  const [images, setImages] = useState([]);\n  const [stream, setStream] = useState(false);\n  const videoRef = useRef();\n  const refCanvas = useRef();\n  const [tracks, setTracks] = useState(\"\");\n\n  const handleChangeImages = (e) => {\n    const files = [...e.target.files];\n    let err = \"\";\n    let newImages = [];\n\n    files.forEach((file) => {\n      if (!file) {\n        return (err = \"File does not exist.\");\n      }\n\n      if (file.size > 1024 * 1024 * 5) {\n        return (err = \"Image size must be less than 5 mb.\");\n      }\n      return newImages.push(file);\n    });\n    if (err) {\n      dispatch({ type: GLOBALTYPES.ALERT, payload: { error: err } });\n    }\n    setImages([...images, ...newImages]);\n  };\n\n  const deleteImages = (index) => {\n    const newArr = [...images];\n    newArr.splice(index, 1);\n    setImages(newArr);\n  };\n\n  const handleStream = () => {\n    setStream(true);\n    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n      navigator.mediaDevices\n        .getUserMedia({ video: true })\n        .then((mediaStream) => {\n          videoRef.current.srcObject = mediaStream;\n          videoRef.current.play();\n          const track = mediaStream.getTracks();\n          setTracks(track[0]);\n        })\n        .catch((err) => console.log(err));\n    }\n  };\n\n  const handleCapture = () => {\n    const width = videoRef.current.clientWidth;\n    const height = videoRef.current.clientHeight;\n\n    refCanvas.current.setAttribute(\"width\", width);\n    refCanvas.current.setAttribute(\"height\", height);\n\n    const ctx = refCanvas.current.getContext(\"2d\");\n    ctx.drawImage(videoRef.current, 0, 0, width, height);\n\n    let URL = refCanvas.current.toDataURL();\n    setImages([...images, { camera: URL }]);\n  };\n\n  const handleStopStream = () => {\n    tracks.stop();\n    setStream(false);\n  };\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    if (images.length === 0) {\n      return dispatch({\n        type: GLOBALTYPES.ALERT,\n        payload: { error: \"Add image(s).\" },\n      });\n    }\n\n    if (status.onEdit) {\n      dispatch(updatePost({ content, images, auth, status }));\n    } else {\n      dispatch(createPost({ content, images, auth, socket }));\n    }\n\n    setContent(\"\");\n    setImages([]);\n    if (tracks) {\n      tracks.stop();\n    }\n    dispatch({\n      type: GLOBALTYPES.STATUS,\n      payload: false,\n    });\n  };\n\n  useEffect(() => {\n    if (status.onEdit) {\n      setContent(status.content);\n      setImages(status.images);\n    }\n  }, [status]);\n\n  \n\n  return (\n    <div className=\"status_modal\">\n      <form onSubmit={handleSubmit}>\n        <div className=\"status_header\">\n          <h5 className=\"m-0\">Create Post</h5>\n          <span\n            onClick={() =>\n              dispatch({ type: GLOBALTYPES.STATUS, payload: false })\n            }\n          >\n            &times;\n          </span>\n        </div>\n        <div className=\"status_body\">\n          <textarea\n            onChange={(e) => setContent(e.target.value)}\n            value={content}\n            name=\"content\"\n            placeholder={`${auth.user.username}, What's on your mind?`}\n            style={{\n              filter: theme ? \"invert(1)\" : \"invert(0)\",\n              color: theme ? \"white\" : \"#111\",\n              background: theme ? \"rgb(0,0,0,0.3)\" : \"\",\n            }}\n          />\n\n          <div className=\"d-flex\">\n            <div className=\"flex-fill\"></div>\n            <Icons setContent={setContent} content={content} theme={theme} />\n          </div>\n\n          <div className=\"show_images\">\n            {images.map((img, index) => (\n              <div key={index} className=\"file_img\">\n                {img.camera ? (\n                  imageShow(img.camera, theme)\n                ) : img.url ? (\n                  <>\n                    {img.url.match(/video/i)\n                      ? videoShow(img.url)\n                      : imageShow(img.url)}\n                  </>\n                ) : (\n                  <>\n                    {img.type.match(/video/i)\n                      ? videoShow(URL.createObjectURL(img, theme))\n                      : imageShow(URL.createObjectURL(img, theme))}\n                  </>\n                )}\n                <span onClick={() => deleteImages(index)}>&times;</span>\n              </div>\n            ))}\n          </div>\n\n          {stream && (\n            <div className=\"stream position-relative\">\n              <video\n                width=\"100%\"\n                height=\"100%\"\n                ref={videoRef}\n                style={{ filter: theme ? \"invert(1)\" : \"invert(0)\" }}\n                autoPlay\n                muted\n              />\n\n              <span onClick={handleStopStream}>&times;</span>\n              <canvas style={{ display: \"none\" }} ref={refCanvas} />\n            </div>\n          )}\n\n          <div className=\"input_images\">\n            {stream ? (\n              <i className=\"fas fa-camera\" onClick={handleCapture} />\n            ) : (\n              <>\n                <i className=\"fas fa-camera\" onClick={handleStream} />\n                <div className=\"file_upload\">\n                  <i className=\"fas fa-image\" />\n                  <input\n                    onChange={handleChangeImages}\n                    type=\"file\"\n                    name=\"file\"\n                    id=\"file\"\n                    multiple\n                    accept=\"image/*,video/*\"\n                  />\n                </div>\n              </>\n            )}\n          </div>\n        </div>\n        <div className=\"status_footer\">\n          <button type=\"submit\" className=\"btn btn-primary w-100\">\n            Post\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default StatusModal;\n"]},"metadata":{},"sourceType":"module"}